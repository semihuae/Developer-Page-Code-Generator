<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Developer Page Generator | SKCore</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1f2937; /* Very Dark Gray Background (Gray-800) */
            color: #d1d5db; /* Default light gray text for body */
            min-height: 100vh;
            display: flex; /* Flex for Sidebar and Content */
            overflow-x: hidden; /* Prevent horizontal scroll */
        }
        .textarea-code {
            resize: vertical;
            min-height: 200px;
            font-family: monospace;
            font-size: 0.85rem;
        }
        /* Modern Indigo Accent */
        .text-accent { color: #818cf8; } /* Indigo-400 for contrast */
        .bg-accent { background-color: #4f46e5; }
        .hover\:bg-accent\:hover:hover { background-color: #4338ca; }
        .focus\:ring-accent:focus { ring-color: #818cf8; }
        
        /* Sidebar Styles */
        #sidebar {
            /* Always fixed on desktop */
            position: fixed; 
            width: 280px;
            height: 100%; /* Full height */
            transition: width 0.3s ease-in-out;
            z-index: 50;
            flex-shrink: 0;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.5);
        }
        .sidebar-closed {
            width: 72px !important; /* Small icon view */
        }
        /* Hide full text when collapsed */
        .sidebar-closed .sidebar-full-text {
            opacity: 0;
            width: 0;
            overflow: hidden;
            pointer-events: none;
            transition: opacity 0.1s ease-out, width 0.1s ease-out;
        }
        /* Navigation items should be centered in 72px width */
        .sidebar-closed .nav-link-item {
            justify-content: center; /* Center icon in the 72px width */
            padding-left: 0;
            padding-right: 0;
        }
        
        /* Content Area */
        #content-area {
            flex-grow: 1;
            /* Default margin for 280px sidebar */
            margin-left: 280px; 
            padding: 2rem;
            transition: margin-left 0.3s ease-in-out;
        }
        .content-area-shifted {
            /* Margin for 72px collapsed sidebar */
            margin-left: 72px !important;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            #sidebar {
                /* Hidden by default on mobile */
                transform: translateX(-100%);
            }
            .sidebar-open-mobile {
                transform: translateX(0) !important;
            }
            #content-area {
                /* No margin on mobile */
                margin-left: 0 !important;
                width: 100%;
            }
            .content-area-shifted {
                margin-left: 0 !important;
            }
        }
    </style>
</head>
<body class="md:flex">
    
    <!-- Left Sidebar (Navigation Menu) -->
    <nav id="sidebar" class="bg-gray-900 border-r border-gray-700 top-0 p-4 flex flex-col">
        
        <!-- Branding and Collapse Button -->
        <div class="flex items-center justify-between pb-6 mb-6 border-b border-gray-700">
            <div class="flex items-center space-x-3 overflow-hidden">
                <img src="https://i.ibb.co/QtmxFc3/SKCore-Logo.png" alt="SKCore Logo" class="h-9 w-auto rounded-md flex-shrink-0">
                <span class="text-3xl font-black text-white tracking-tight sidebar-full-text whitespace-nowrap">SKCore</span>
            </div>
            <!-- Toggle Button (Desktop Only) -->
            <button onclick="toggleSidebar()" class="text-gray-400 hover:text-white transition hidden md:block flex-shrink-0" aria-label="Toggle Sidebar">
                <!-- Icon is managed by JS in toggleSidebar function -->
                <svg id="toggleIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12H5"/><path d="m12 5-7 7 7 7"/></svg>
            </button>
        </div>
        
        <!-- Navigation Links -->
        <ul class="space-y-3 flex-grow">
            <!-- Dashboard Link -->
            <li>
                <button onclick="switchView('dashboard')" class="nav-link-item w-full flex items-center p-3 rounded-xl transition duration-150 text-white bg-gray-800 hover:bg-gray-700 active-link">
                    <!-- Icon -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-3 flex-shrink-0"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
                    <!-- Text -->
                    <span class="font-medium sidebar-full-text">Dashboard</span>
                </button>
            </li>
            
            <!-- Generator Link -->
            <li>
                <button onclick="switchView('generator')" class="nav-link-item w-full flex items-center p-3 rounded-xl transition duration-150 text-gray-300 hover:bg-gray-800 hover:text-white inactive-link">
                    <!-- Icon -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-3 flex-shrink-0"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><path d="M16 13H8"/><path d="M16 17H8"/><path d="M10 9H8"/></svg>
                    <!-- Text -->
                    <span class="font-medium sidebar-full-text">Page Generator</span>
                </button>
            </li>
        </ul>
        
        <!-- Footer / Developer Info (only shown when expanded) -->
        <div class="mt-8 border-t border-gray-700 pt-4 sidebar-full-text overflow-hidden">
            <p class="text-xs text-gray-500 whitespace-nowrap">SKCore App Shell v1.1</p>
        </div>
    </nav>

    <!-- Content Area (Dashboard and Generator Content) -->
    <main id="content-area" class="w-full md:p-8 overflow-y-auto">
        
        <!-- Mobile Menu Toggle Button (Mobile Only) -->
        <button id="mobileMenuButton" onclick="toggleMobileSidebar()" class="fixed top-4 left-4 z-50 p-2 bg-gray-900 rounded-full shadow-lg md:hidden text-white transition">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
        </button>

        <div class="max-w-6xl mx-auto">
            
            <!-- Dashboard View -->
            <div id="dashboard-view" class="view hidden">
                <div class="bg-gray-900 shadow-2xl rounded-xl p-8 md:p-12 border border-gray-700">
                    <h1 class="text-4xl font-extrabold text-accent mb-4">Dashboard</h1>
                    <p class="text-gray-400 mb-6">Welcome! This will be the main control panel for your application. You can access the Page Generator from the left menu.</p>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-xl font-bold text-white mb-2">Last Update</h3>
                            <p class="text-gray-500">Generator: October 22, 2025</p>
                        </div>
                        <div class="bg-gray-800 p-6 rounded-lg border border-gray-700">
                            <h3 class="text-xl font-bold text-white mb-2">Quick Access</h3>
                            <button onclick="switchView('generator')" class="text-accent hover:text-indigo-400 font-semibold mt-2">Go to Generator &rarr;</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Generator View (Current Content) -->
            <div id="generator-view" class="view hidden">
                <div class="max-w-6xl mx-auto bg-gray-900 shadow-2xl rounded-xl p-8 md:p-12 border border-gray-700">
                    
                    <h1 class="text-3xl font-extrabold text-white mb-2">Developer Page Content Generator</h1>
                    <p class="text-gray-400 mb-10">Enter the required information below. Your customized Privacy Policy and Support pages will be generated instantly, using the modern SKCore template structure.</p>

                    <!-- USER INPUTS -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12 p-6 rounded-xl bg-gray-800 border border-gray-700">
                        <h2 class="md:col-span-2 text-xl font-bold text-gray-200 mb-4">1. Required Information</h2>
                        
                        <div>
                            <label for="appName" class="block text-sm font-medium text-gray-300 mb-1">App Name (<span class="font-mono text-red-400">[APP_NAME]</span>)</label>
                            <input type="text" id="appName" value="Awesome Game Title" class="mt-1 block w-full rounded-lg border-gray-600 bg-gray-700 text-white shadow-sm p-3 border focus:ring-accent focus:border-accent">
                        </div>
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-300 mb-1">Email Address (<span class="font-mono text-red-400">[CONTACT_EMAIL]</span>)</label>
                            <input type="email" id="email" value="support@examplegame.com" class="mt-1 block w-full rounded-lg border-gray-600 bg-gray-700 text-white shadow-sm p-3 border focus:ring-accent focus:border-accent">
                        </div>
                        <div>
                            <label for="name" class="block text-sm font-medium text-gray-300 mb-1">Name/Developer Name (<span class="font-mono text-red-400">[DEV_NAME]</span>)</label>
                            <input type="text" id="name" value="John Doe (Software Developer)" class="mt-1 block w-full rounded-lg border-gray-600 bg-gray-700 text-white shadow-sm p-3 border focus:ring-accent focus:border-accent">
                        </div>
                        <div>
                            <label for="phone" class="block text-sm font-medium text-gray-300 mb-1">Phone Number (Optional) (<span class="font-mono text-red-400">[PHONE_NUMBER]</span>)</label>
                            <input type="tel" id="phone" value="+1 555 123 45 67" class="mt-1 block w-full rounded-lg border-gray-600 bg-gray-700 text-white shadow-sm p-3 border focus:ring-accent focus:border-accent">
                        </div>
                    </div>

                    <!-- GENERATE BUTTON -->
                    <div class="text-center mb-12">
                        <button onclick="generateFiles()" class="px-12 py-4 bg-accent text-white font-bold text-xl rounded-full shadow-lg shadow-indigo-500/50 hover:bg-accent\:hover transition duration-300 transform hover:scale-105">
                            2. Generate HTML Files
                        </button>
                    </div>

                    <!-- OUTPUT AREAS -->
                    <h2 class="text-2xl font-semibold text-gray-200 mb-6 border-b border-gray-700 pb-2">3. Generated HTML Code (Copy Below)</h2>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div>
                            <label for="privacyOutput" class="block text-lg font-medium text-gray-300 mb-2">Privacy Policy</label>
                            <textarea id="privacyOutput" readonly class="textarea-code block w-full rounded-lg border border-gray-600 shadow-inner p-4 bg-gray-800 text-green-300"></textarea>
                            <div class="flex space-x-4 mt-3">
                                <button onclick="copyToClipboard('privacyOutput', this)" class="w-1/2 py-3 bg-green-500 text-white rounded-lg text-base font-medium hover:bg-green-600 transition">Copy Code</button>
                                <button onclick="previewCode('privacyOutput', 'Privacy Policy')" class="w-1/2 py-3 bg-blue-500 text-white rounded-lg text-base font-medium hover:bg-blue-600 transition">Preview</button>
                            </div>
                        </div>
                        <div>
                            <label for="supportOutput" class="block text-lg font-medium text-gray-300 mb-2">Support Page</label>
                            <textarea id="supportOutput" readonly class="textarea-code block w-full rounded-lg border border-gray-600 shadow-inner p-4 bg-gray-800 text-green-300"></textarea>
                            <div class="flex space-x-4 mt-3">
                                <button onclick="copyToClipboard('supportOutput', this)" class="w-1/2 py-3 bg-green-500 text-white rounded-lg text-base font-medium hover:bg-green-600 transition">Copy Code</button>
                                <button onclick="previewCode('supportOutput', 'Support Page')" class="w-1/2 py-3 bg-blue-500 text-white rounded-lg text-base font-medium hover:bg-blue-600 transition">Preview</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

        </div> <!-- max-w-6xl mx-auto End -->

    </main>

    <script>
        // --- VIEW MANAGEMENT ---
        let activeView = 'dashboard';
        let isSidebarCollapsed = false;
        let isMobileSidebarOpen = false;

        function switchView(viewName) {
            activeView = viewName;
            const views = document.querySelectorAll('.view');
            const navButtons = document.querySelectorAll('#sidebar button');
            
            // Hide/Show Views
            views.forEach(view => {
                view.classList.add('hidden');
            });
            const selectedView = document.getElementById(viewName + '-view');
            if (selectedView) {
                selectedView.classList.remove('hidden');
                // Close mobile menu if open when switching views
                if (window.innerWidth < 768 && isMobileSidebarOpen) {
                    toggleMobileSidebar();
                }
            }

            // Highlight Active Navigation Button
            navButtons.forEach(button => {
                button.classList.remove('bg-gray-800', 'active-link');
                button.classList.add('text-gray-300', 'hover:bg-gray-800', 'hover:text-white', 'inactive-link');

                if (button.onclick.toString().includes(`switchView('${viewName}')`)) {
                    button.classList.add('bg-gray-800', 'active-link');
                    button.classList.remove('text-gray-300', 'inactive-link');
                }
            });
            
            // Run generator to load default values when accessing generator view
            if (viewName === 'generator') {
                generateFiles();
            }

            alertUser(viewName.charAt(0).toUpperCase() + viewName.slice(1) + ' view opened.');
        }

        // Sidebar Collapse/Expand (Desktop Only)
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const contentArea = document.getElementById('content-area');
            const fullTextElements = sidebar.querySelectorAll('.sidebar-full-text');
            const navLinkItems = sidebar.querySelectorAll('.nav-link-item');
            const toggleIcon = document.getElementById('toggleIcon');
            
            isSidebarCollapsed = !isSidebarCollapsed;
            
            if (isSidebarCollapsed) {
                // Collapse: Sidebar 72px, Content margin 72px
                sidebar.classList.add('sidebar-closed');
                contentArea.classList.add('content-area-shifted');

                // Change icon to Open Arrow (points right)
                toggleIcon.innerHTML = '<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>'; 
                
                // Hide full text
                fullTextElements.forEach(el => el.classList.remove('flex'));
                
                // Center navigation icons
                navLinkItems.forEach(item => item.classList.add('justify-center', 'px-0'));

            } else {
                // Expand: Sidebar 280px, Content margin 280px
                sidebar.classList.remove('sidebar-closed');
                contentArea.classList.remove('content-area-shifted');

                // Change icon to Close Arrow (points left)
                toggleIcon.innerHTML = '<path d="M19 12H5"/><path d="m12 5-7 7 7 7"/>'; 

                // Show full text
                fullTextElements.forEach(el => el.classList.add('flex'));

                // Restore left alignment
                navLinkItems.forEach(item => item.classList.remove('justify-center', 'px-0'));
            }
        }

        // Sidebar Mobile Toggle
        function toggleMobileSidebar() {
            const sidebar = document.getElementById('sidebar');
            isMobileSidebarOpen = !isMobileSidebarOpen;
            
            if (isMobileSidebarOpen) {
                sidebar.classList.add('sidebar-open-mobile');
            } else {
                sidebar.classList.remove('sidebar-open-mobile');
            }
        }

        // --- GENERATOR LOGIC ---

        // --- HIDDEN TEMPLATES (Stored internally in JS) ---
        // Note: Inline CSS is used in templates for maximum compatibility when users host these pages.
        const PRIVACY_TEMPLATE = `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[APP_NAME] Privacy Policy</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700&display=swap');
        body { font-family: 'Inter', sans-serif; max-width: 900px; margin: auto; padding: 40px 20px; line-height: 1.8; color: #d1d5db; background-color: #1f2937; }
        header { border-bottom: 3px solid #4f46e5; padding-bottom: 15px; margin-bottom: 30px; }
        h1 { color: #f9fafb; font-size: 2.2rem; font-weight: 800; }
        h2 { color: #818cf8; font-size: 1.6rem; font-weight: 700; margin-top: 40px; margin-bottom: 15px; padding-bottom: 5px; border-bottom: 1px solid #4b5563; }
        p { margin-bottom: 15px; font-weight: 500; }
        a { color: #818cf8; text-decoration: none; border-bottom: 1px dotted #818cf8; }
        footer { margin-top: 60px; padding-top: 20px; border-top: 1px solid #4b5563; font-size: 0.9rem; color: #9ca3af; text-align: center; }
        ul { list-style-type: none; padding-left: 20px; }
        li::before { content: "›"; color: #818cf8; font-weight: bold; display: inline-block; width: 1em; margin-left: -1em; }
    </style>
</head>
<body>
    <header><h1>[APP_NAME] Privacy Policy</h1></header>
    <main>
        <p>This Privacy Policy applies to the <b>[APP_NAME]</b> application (the "App"), developed and owned by <b>[DEV_NAME]</b> (SKCore).</p>
        
        <h2>Contact Information</h2>
        <p>If you have questions about this policy or our data practices, please contact us:</p>
        <p>Email: <a href="mailto:[CONTACT_EMAIL]"><b>[CONTACT_EMAIL]</b></a></p>
        
        <h2>Data Collection and Use</h2>
        <p>The App is designed to be privacy-first. We do not collect personally identifiable information (PII) such as your name, address, or email directly within the App's core functionality.</p>
        <ul>
            <li><strong>Non-Personal Data:</strong> We may collect anonymized usage statistics (e.g., crash reports, session length) solely to improve the App's performance and stability. This data is aggregated and cannot be used to identify individual users.</li>
            <li><strong>Permissions:</strong> If the App requires specific permissions (e.g., camera, location), these are used *only* for the stated functionality within the App and are never stored or transmitted externally.</li>
        </ul>

        <h2>Third-Party Services</h2>
        <p>We do not share any data with external third parties or advertisers.</p>
        
        <h2>Policy Updates</h2>
        <p>We may update this Privacy Policy periodically. We will notify you of any changes by posting the new policy on this page. This policy was last updated on <strong>October 2025</strong>.</p>
    </main>
    <footer>
        &copy; 2025 SKCore | All Rights Reserved.
    </footer>
</body>
</html>
        `.trim();

        const SUPPORT_TEMPLATE = `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>[APP_NAME] Support</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700&display=swap');
        body { font-family: 'Inter', sans-serif; max-width: 900px; margin: auto; padding: 40px 20px; line-height: 1.8; color: #d1d5db; background-color: #1f2937; }
        header { border-bottom: 3px solid #4f46e5; padding-bottom: 15px; margin-bottom: 30px; }
        h1 { color: #f9fafb; font-size: 2.2rem; font-weight: 800; }
        h2 { color: #818cf8; font-size: 1.6rem; font-weight: 700; margin-top: 40px; margin-bottom: 15px; padding-bottom: 5px; border-bottom: 1px solid #4b5563; }
        p { margin-bottom: 15px; font-weight: 500; }
        a { color: #818cf8; text-decoration: none; border-bottom: 1px dotted #818cf8; }
        footer { margin-top: 60px; padding-top: 20px; border-top: 1px solid #4b5563; font-size: 0.9rem; color: #9ca3af; text-align: center; }
    </style>
</head>
<body>
    <header><h1>[APP_NAME] Support and Contact</h1></header>
    <main>
        <p>Welcome to the support page for <b>[APP_NAME]</b>, developed by <b>[DEV_NAME]</b> (SKCore).</p>
        
        <h2>Primary Contact Channel</h2>
        <p>The fastest way to get support for technical issues, bug reports, and feature requests is via email. We aim to respond to all inquiries within 48 hours.</p>
        <p style="font-size: 1.1rem; font-weight: 700;">Email: <a href="mailto:[CONTACT_EMAIL]"><b>[CONTACT_EMAIL]</b></a></p>
        
        <h2>Developer Details</h2>
        <p>App Name: <b>[APP_NAME]</b></p>
        <p>Developer: <b>[DEV_NAME]</b></p>
        <p>Phone: <b>[PHONE_NUMBER]</b></p>

        <h2>FAQs and Known Issues</h2>
        <p>Please check for any known issues or frequently asked questions below. This section is currently under construction, but feel free to email us directly!</p>
    </main>
    <footer>
        &copy; 2025 SKCore | All Rights Reserved.
    </footer>
</body>
</html>
        `.trim();
        // --- END OF HIDDEN TEMPLATES ---

        function generateFiles() {
            // 1. Get Inputs
            const appName = document.getElementById('appName').value.trim();
            const email = document.getElementById('email').value.trim();
            const name = document.getElementById('name').value.trim();
            const phone = document.getElementById('phone').value.trim();

            if (!appName || !email || !name) {
                // Show warning only in Generator view.
                if (activeView === 'generator') {
                     alertUser('Please fill in App Name, Email, and Developer Name fields.');
                }
                return;
            }

            // 2. Replacement List (Using Global Regex)
            const replacements = [
                { placeholder: /\[APP_NAME\]/g, value: appName },
                { placeholder: /\[CONTACT_EMAIL\]/g, value: email },
                { placeholder: /\[DEV_NAME\]/g, value: name },
                { placeholder: /\[PHONE_NUMBER\]/g, value: phone },
            ];

            // 3. Generate Privacy Policy
            let newPrivacy = PRIVACY_TEMPLATE;
            replacements.forEach(r => {
                newPrivacy = newPrivacy.replace(r.placeholder, r.value);
            });

            // 4. Generate Support Page
            let newSupport = SUPPORT_TEMPLATE;
            replacements.forEach(r => {
                newSupport = newSupport.replace(r.placeholder, r.value);
            });

            // 5. Display Outputs
            document.getElementById('privacyOutput').value = newPrivacy;
            document.getElementById('supportOutput').value = newSupport;

            if (activeView === 'generator') {
                alertUser('HTML Codes Generated Successfully!');
            }
        }

        // --- NEW PREVIEW FUNCTIONALITY ---
        function previewCode(elementId, title) {
            const textarea = document.getElementById(elementId);
            if (!textarea || !textarea.value) {
                alertUser('Please generate files first before previewing.');
                return;
            }

            const htmlContent = textarea.value;

            // Warning message HTML structure (in English, as requested)
            const previewWarning = `
                <div style="background-color: #f87171; color: #1f2937; padding: 15px; border: 2px solid #ef4444; margin-bottom: 25px; border-radius: 8px; text-align: center; font-family: 'Inter', sans-serif;">
                    <h3 style="font-weight: 900; font-size: 1.1rem; margin: 0 0 5px 0;">ATTENTION: PREVIEW MODE ONLY</h3>
                    <p style="margin: 0; font-size: 0.9rem;">Do not use this link for public deployment. This is a temporary preview generated locally for verification. Please copy the actual code below and publish it on your chosen host (e.g., Vercel, Blogspot, your own server) for your official page. This message will <strong>NOT</strong> appear in the copied HTML code.</p>
                </div>
            `;
            
            // Inject warning right after the <body> tag for the preview only
            // This ensures the original textarea value remains clean
            const modifiedContent = htmlContent.replace(/<body>/, `<body>${previewWarning}`);

            try {
                // 1. Create a Blob object from the MODIFIED HTML content
                const blob = new Blob([modifiedContent], { type: 'text/html' });
                
                // 2. Create a temporary URL for the Blob
                const url = URL.createObjectURL(blob);
                
                // 3. Open the URL in a new tab
                window.open(url, '_blank');
                
                alertUser(title + ' preview opened in a new tab.');

            } catch (error) {
                console.error("Preview failed:", error);
                alertUser('Failed to open preview. Console logged for details.');
            }
        }
        // --- END PREVIEW FUNCTIONALITY ---

        // Copy function
        function copyToClipboard(elementId, buttonElement) {
            const textarea = document.getElementById(elementId);
            if (textarea && textarea.value) {
                // Using document.execCommand('copy') due to iframe restrictions
                textarea.select();
                document.execCommand('copy');
                
                const originalText = buttonElement.textContent;
                buttonElement.textContent = 'Copied!';
                buttonElement.classList.remove('bg-green-500');
                buttonElement.classList.add('bg-indigo-400');
                buttonElement.classList.remove('hover:bg-green-600');
                
                setTimeout(() => {
                    buttonElement.textContent = originalText;
                    buttonElement.classList.add('bg-green-500');
                    buttonElement.classList.remove('bg-indigo-400');
                    buttonElement.classList.add('hover:bg-green-600');
                }, 1500);
            } else {
                alertUser('Please generate files first.');
            }
        }

        // Custom Modal Alert (replacing alert())
        function alertUser(message) {
            let alertBox = document.getElementById('customAlert');
            if (!alertBox) {
                alertBox = document.createElement('div');
                alertBox.id = 'customAlert';
                alertBox.className = 'fixed top-4 right-4 bg-accent text-white px-5 py-3 rounded-lg shadow-xl transition-transform transform translate-x-full z-50 font-semibold';
                document.body.appendChild(alertBox);
            }
            alertBox.textContent = message;
            alertBox.classList.remove('translate-x-full');
            
            setTimeout(() => {
                alertBox.classList.add('translate-x-full');
            }, 3000);
        }

        // Set default view on page load
        window.onload = function() {
            // Open Dashboard view first
            switchView('dashboard'); 
            
            // Adjust mobile menu button visibility
            if (window.innerWidth < 768) {
                document.getElementById('mobileMenuButton').classList.remove('hidden');
            } else {
                // Ensure desktop sidebar starts expanded
                // The toggleSidebar function is called once at the start to ensure the correct state is set
                if (isSidebarCollapsed) {
                    toggleSidebar();
                }
            }
        };
    </script>
</body>
</html>
